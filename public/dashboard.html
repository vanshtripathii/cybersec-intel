<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CyberSec Intel Dashboard</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #0a0a0a, #1a1a2e, #16213e, #0f0f23);
            color: #4fc3f7;
            min-height: 100vh;
            padding: 8px;
            margin: 0;
            overflow-x: hidden;
        }

        .main-grid {
            display: grid;
            grid-template-columns: 200px 1fr 280px;
            grid-template-rows: auto auto;
            gap: 10px;
            min-height: calc(100vh - 120px);
        }

        .left-panel {
            margin-top: 20px;
            display: flex;
            flex-direction: column;
            gap: 15px;
            height: fit-content;
        }
        
        .circle {
            width: 200px;
            height: 200px;
            border-radius: 50%;
            border: 2px solid #4fc3f7;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-direction: column;
            position: relative;
            background: radial-gradient(circle, rgba(79, 195, 247, 0.1), transparent);
            overflow: hidden;
            transition: all 0.3s ease;
        }

        .circle:hover {
            transform: scale(1.05);
            border-color: #00b3ff;
            box-shadow: 0 0 25px rgba(79, 195, 247, 0.4);
        }

        .circle::after {
            content: '';
            position: absolute;
            top: -4px;
            left: -4px;
            right: -4px;
            bottom: -4px;
            border-radius: 50%;
            border: 3px dotted #4fc3f7;
            animation: rotateDots 4s linear infinite;
        }

        .circle.critical::after {
            border-color: #f44336;
        }

        .circle.alerts::after {
            border-color: #ff9800;
        }

        .circle::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: conic-gradient(
                transparent 0deg,
                transparent 270deg,
                rgba(79, 195, 247, 0.8) 280deg,
                rgba(79, 195, 247, 0.4) 290deg,
                transparent 300deg
            );
            animation: radarSweep 3s linear infinite;
            border-radius: 50%;
        }

        .circle.critical::before {
            background: conic-gradient(
                transparent 0deg,
                transparent 270deg,
                rgba(244, 67, 54, 0.8) 280deg,
                rgba(244, 67, 54, 0.4) 290deg,
                transparent 300deg
            );
        }

        .circle.alerts::before {
            background: conic-gradient(
                transparent 0deg,
                transparent 270deg,
                rgba(255, 152, 0, 0.8) 280deg,
                rgba(255, 152, 0, 0.4) 290deg,
                transparent 300deg
            );
        }

        .circle-value {
            font-size: 16px;
            font-weight: bold;
            color: #ffffff;
            position: relative;
            z-index: 2;
            text-shadow: 0 0 8px rgba(255, 255, 255, 0.5);
        }

        .circle-label {
            font-size: 10px;
            color: #4fc3f7;
            margin-top: 3px;
            bottom: 50px;
            position: absolute;
            z-index: 2;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .map-container {
            grid-column: 2;
            grid-row: 1 / 3;
            position: relative;
            min-height: 600px;
            overflow: hidden;
            backdrop-filter: blur(10px);
        }

        #worldMap {
            width: 100%;
            height: 100%;
            position: relative;
        }

        .map-legend {
            position: absolute;
            bottom: 15px;
            left: 15px;
            padding: 10px;
            font-size: 10px;
            z-index: 1000;
        }

        .legend-item {
            display: flex;
            align-items: center;
            margin-bottom: 8px;
        }

        .legend-color {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            margin-right: 8px;
            box-shadow: 0 0 6px rgba(0,0,0,0.5);
        }

        .critical-threat { background: #f44336; }
        .high-threat { background: #ff9800; }
        .low-threat { background: #4caf50; }

        .right-panel {
            display: flex;
            flex-direction: column;
            gap: 15px;
            height: fit-content;
        }

        .threat-intel-feed {
            background: rgba(0, 0, 0, 0.2);
            border: 1px solid #2196f3;
            border-radius: 15px;
            padding: 15px;
            backdrop-filter: blur(20px);
            height: fit-content;
            max-height: 350px;
            overflow-y: auto;
            transition: all 0.3s ease;
        }

        .threat-intel-feed:hover {
            border-color: #4fc3f7;
            box-shadow: 0 0 20px rgba(79, 195, 247, 0.2);
        }

        .threat-intel-list {
            display: flex;
            flex-direction: column;
            gap: 8px;
            margin-top: 10px;
        }

        .threat-intel-item {
            background: rgba(0, 0, 0, 0.3);
            border: 1px solid rgba(33, 150, 243, 0.3);
            border-radius: 8px;
            padding: 10px;
            font-size: 10px;
            animation: slideInRight 0.5s ease-out;
            border-left: 3px solid #f44336;
            position: relative;
            overflow: hidden;
            transition: all 0.3s ease;
        }

        .threat-intel-item:hover {
            transform: translateX(5px);
            border-color: #4fc3f7;
            box-shadow: 0 5px 15px rgba(79, 195, 247, 0.3);
        }

        .threat-intel-item.high {
            border-left-color: #ff9800;
        }

        .threat-intel-item.low {
            border-left-color: #4caf50;
        }

        .threat-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 4px;
        }

        .threat-source {
            font-weight: bold;
            color: #4fc3f7;
            font-size: 9px;
            text-transform: uppercase;
        }

        .threat-time {
            margin-top: 10px;
            color: #ffffff;
            opacity: 0.7;
            font-size: 8px;
        }

        .threat-location {
            color: #ff9800;
            font-size: 8px;
            font-weight: bold;
        }

        .threat-description {
            color: #ffffff;
            line-height: 1.3;
            margin-top: 2px;
        }

        .threat-severity {
            position: absolute;
            top: 6px;
            right: 6px;
            padding: 3px 8px;
            border-radius: 4px;
            font-size: 7px;
            font-weight: bold;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .severity-critical {
            background: linear-gradient(45deg, #f44336, #d32f2f);
            color: #ffffff;
        }

        .severity-high {
            background: linear-gradient(45deg, #ff9800, #f57c00);
            color: #ffffff;
        }

        .severity-low {
            background: linear-gradient(45deg, #4caf50, #388e3c);
            color: #ffffff;
        }

        .right-chart {
            background: rgba(0, 0, 0, 0.2);
            border: 1px solid #2196f3;
            border-radius: 15px;
            padding: 15px;
            backdrop-filter: blur(20px);
            display: flex;
            align-items: center;
            justify-content: center;
            height: 140px;
            transition: all 0.3s ease;
        }

        .right-chart:hover {
            border-color: #4fc3f7;
            box-shadow: 0 0 20px rgba(79, 195, 247, 0.2);
        }

        .gauge-chart {
            position: relative;
            width: 90px;
            height: 90px;
        }

        .gauge-bg {
            width: 100%;
            height: 100%;
            border-radius: 50%;
            border: 8px solid rgba(79, 195, 247, 0.2);
            position: relative;
        }

        .gauge-fill {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            border-radius: 50%;
            border: 4px solid transparent;
            border-top-color: #4fc3f7;
            transform: rotate(360deg);
            animation: gaugeRotate 2s ease-in-out infinite;
        }

        .gauge-center {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            text-align: center;
        }

        .gauge-value {
            font-size: 12px;
            font-weight: bold;
            color: #ffffff;
            text-shadow: 0 0 5px rgba(255, 255, 255, 0.5);
        }

        .gauge-label {
            font-size: 8px;
            color: #4fc3f7;
            margin-top: 3px;
            text-transform: uppercase;
        }

        .recent-alerts {
            background: rgba(0, 0, 0, 0.2);
            border: 1px solid #2196f3;
            border-radius: 15px;
            padding: 12px;
            backdrop-filter: blur(20px);
            height: 150px;
            overflow: hidden;
            position: relative;
            transition: all 0.3s ease;
        }

        .recent-alerts:hover {
            border-color: #4fc3f7;
            box-shadow: 0 0 20px rgba(79, 195, 247, 0.2);
        }

        .alerts-container {
            display: flex;
            flex-direction: column;
            gap: 8px;
            animation: scrollAlerts 20s linear infinite;
        }

        @keyframes scrollAlerts {
            0% {
                transform: translateY(0);
            }
            100% {
                transform: translateY(calc(-100% + 150px));
            }
        }

        .bottom-panels {
            grid-column: 1 / 4;
            display: flex;
            gap: 15px;
            margin-top: 15px;
            flex-wrap: wrap;
        }

        .bottom-panel {
            flex: 1;
            background: rgba(0, 0, 0, 0.2);
            border: 1px solid #2196f3;
            border-radius: 15px;
            padding: 15px;
            backdrop-filter: blur(20px);
            min-width: 280px;
            height: fit-content;
            transition: all 0.3s ease;
        }

        .bottom-panel:hover {
            border-color: #4fc3f7;
            box-shadow: 0 0 20px rgba(79, 195, 247, 0.2);
            transform: translateY(-2px);
        }

        .panel-title {
            font-size: 12px;
            color: #4fc3f7;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 8px;
            text-transform: uppercase;
            font-weight: bold;
            letter-spacing: 0.5px;
        }

        .threat-item {
            padding: 8px;
            margin-bottom: 8px;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 6px;
            font-size: 9px;
            border-left: 3px solid #f44336;
            animation: slideInLeft 0.5s ease-out;
            transition: all 0.3s ease;
        }

        .threat-item:hover {
            transform: translateX(5px);
            box-shadow: 0 3px 10px rgba(79, 195, 247, 0.3);
        }

        .threat-item.high {
            border-left-color: #ff9800;
        }

        .threat-item.low {
            border-left-color: #4caf50;
        }

        .alert-item {
            padding: 8px;
            margin-bottom: 8px;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 6px;
            font-size: 9px;
            animation: slideInRight 0.5s ease-out;
            border-left: 3px solid #4fc3f7;
            transition: all 0.3s ease;
        }

        .alert-item:hover {
            transform: translateX(-5px);
            box-shadow: 0 3px 10px rgba(79, 195, 247, 0.3);
        }

        .device-cloud {
            text-align: center;
            padding: 15px;
        }

        .device-type {
            display: inline-block;
            margin: 4px;
            padding: 4px 8px;
            background: linear-gradient(45deg, rgba(79, 195, 247, 0.2), rgba(33, 150, 243, 0.2));
            border: 1px solid rgba(79, 195, 247, 0.3);
            border-radius: 12px;
            font-size: 9px;
            color: #4fc3f7;
            animation: float 3s ease-in-out infinite;
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .device-type:hover {
            background: linear-gradient(45deg, rgba(79, 195, 247, 0.4), rgba(33, 150, 243, 0.4));
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(79, 195, 247, 0.3);
        }

        .device-type:nth-child(2n) { animation-delay: 0.5s; }
        .device-type:nth-child(3n) { animation-delay: 1s; }

        .web-line {
            position: absolute;
            height: 2px;
            background: rgba(244, 67, 54, 0.7);
            transform-origin: left center;
            z-index: 850;
            animation: webSpread 2s ease-out forwards;
            opacity: 0;
        }

        @keyframes webSpread {
            0% {
                width: 0;
                opacity: 0;
            }
            50% {
                opacity: 0.8;
            }
            100% {
                width: var(--final-width);
                opacity: 0.4;
            }
        }

        .web-line::after {
            content: '';
            position: absolute;
            right: 0;
            top: 50%;
            transform: translateY(-50%);
            width: 6px;
            height: 6px;
            border-radius: 50%;
            background: #f44336;
            box-shadow: 0 0 8px #f44336;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% {
                transform: translateY(-50%) scale(1);
            }
            50% {
                transform: translateY(-50%) scale(1.3);
            }
        }

        /* Animated attack lines */
        .attack-line {
            position: absolute;
            height: 3px;
            background: linear-gradient(90deg, 
                rgba(244, 67, 54, 0.9) 0%, 
                rgba(255, 87, 34, 0.8) 30%, 
                rgba(255, 193, 7, 0.6) 60%, 
                rgba(76, 175, 80, 0.4) 100%
            );
            transform-origin: left center;
            z-index: 870;
            border-radius: 2px;
            box-shadow: 0 0 10px rgba(244, 67, 54, 0.5);
            opacity: 0;
            animation: attackLineGrow 0.5s ease-out forwards;
        }

        @keyframes attackLineGrow {
            0% {
                width: 0;
                opacity: 0;
                box-shadow: 0 0 5px rgba(244, 67, 54, 0.3);
            }
            20% {
                opacity: 0.8;
                box-shadow: 0 0 15px rgba(244, 67, 54, 0.6);
            }
            100% {
                width: var(--line-length);
                opacity: 0.9;
                box-shadow: 0 0 20px rgba(244, 67, 54, 0.8);
            }
        }

        .attack-line::before {
            content: '';
            position: absolute;
            left: 0;
            top: 50%;
            transform: translateY(-50%);
            width: 8px;
            height: 8px;
            background: #f44336;
            border-radius: 50%;
            box-shadow: 0 0 12px #f44336;
            animation: attackPulse 1.5s ease-out;
        }

        .attack-line::after {
            content: '';
            position: absolute;
            right: 0;
            top: 50%;
            transform: translateY(-50%);
            width: 0;
            height: 0;
            border-left: 12px solid #f44336;
            border-top: 6px solid transparent;
            border-bottom: 6px solid transparent;
            box-shadow: 0 0 15px rgba(244, 67, 54, 0.7);
            animation: attackArrow 0.5s ease-out;
        }

        @keyframes attackPulse {
            0% {
                transform: translateY(-50%) scale(0.5);
                box-shadow: 0 0 5px #f44336;
            }
            50% {
                transform: translateY(-50%) scale(1.2);
                box-shadow: 0 0 20px #f44336;
            }
            100% {
                transform: translateY(-50%) scale(1);
                box-shadow: 0 0 12px #f44336;
            }
        }

        @keyframes attackArrow {
            0% {
                opacity: 0;
                transform: translateY(-50%) scale(0.5);
            }
            70% {
                opacity: 0;
            }
            100% {
                opacity: 1;
                transform: translateY(-50%) scale(1);
            }
        }

        /* Attack data packet animation */
        .attack-packet {
            position: absolute;
            width: 6px;
            height: 6px;
            background: #ff5722;
            border-radius: 50%;
            z-index: 880;
            box-shadow: 0 0 8px #ff5722;
            animation: packetMove 0.5s ease-in-out;
        }

        @keyframes packetMove {
            0% {
                transform: scale(0.5);
                opacity: 0;
            }
            10% {
                transform: scale(1);
                opacity: 1;
            }
            90% {
                transform: scale(1);
                opacity: 1;
            }
            100% {
                transform: scale(0.5);
                opacity: 0;
            }
        }

        /* Threat dots */
        .threat-dot {
            position: absolute;
            width: 10px;
            height: 10px;
            border-radius: 50%;
            transform: translate(-50%, -50%);
            z-index: 800;
            animation: dotPulse 3s infinite;
            cursor: pointer;
        }

        .threat-dot.critical { 
            background: #f44336;
            box-shadow: 0 0 15px #f44336;
        }
        .threat-dot.high { 
            background: #ff9800;
            box-shadow: 0 0 12px #ff9800;
        }
        .threat-dot.low { 
            background: #4caf50;
            box-shadow: 0 0 8px #4caf50;
        }

        @keyframes dotPulse {
            0%, 100% { transform: translate(-50%, -50%) scale(1); }
            50% { transform: translate(-50%, -50%) scale(1.5); }
        }

        /* Attacker base */
        .attacker-base {
            position: inherit;
            width: 30px;
            height: 30px;
            background: rgba(244, 67, 54, 0.2);
            border: 2px solid #f44336;
            border-radius: 50%;
            bottom: 50px;
            left: 50%;
            transform: translateX(-50%);
            display: flex;
            justify-content: center;
            align-items: center;
            color: #ff5252;
            font-size: 16px;
            text-transform: uppercase;
            letter-spacing: 1px;
            z-index: 900;
            animation: basePulse 2s infinite;
            cursor: pointer;
        }

        @keyframes basePulse {
            0%, 100% { 
                box-shadow: 0 0 10px rgba(244, 67, 54, 0.5);
                transform: translateX(-50%) scale(1);
            }
            50% { 
                box-shadow: 0 0 25px rgba(244, 67, 54, 0.8);
                transform: translateX(-50%) scale(1.1);
            }
        }

        /* Connection lines */
        .connection-line {
            position: absolute;
            height: 2px;
            background: rgba(244, 67, 54, 0.3);
            transform-origin: left center;
            z-index: 850;
            animation: linePulse 2s infinite;
        }

        @keyframes linePulse {
            0%, 100% { opacity: 1.0; }
            50% { opacity: 0.3; }
        }

        /* Country outlines */
        .country {
            fill: none;
            stroke: #4fc3f7;
            stroke-width: 0.3;
            stroke-opacity: 0.3;
            transition: all 0.3s ease;
        }

        .country:hover {
            stroke-opacity: 0.8;
            stroke-width: 0.5;
        }

        /* Loading spinner */
        .loading {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            color: #4fc3f7;
            font-size: 10px;
        }

        .spinner {
            width: 20px;
            height: 20px;
            border: 2px solid rgba(79, 195, 247, 0.3);
            border-top: 2px solid #4fc3f7;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* Tooltip styles */
        .tooltip {
            position: absolute;
            padding: 8px;
            background: rgba(0, 0, 0, 0.85);
            border: 1px solid #4fc3f7;
            border-radius: 6px;
            pointer-events: none;
            z-index: 1000;
            font-size: 10px;
            max-width: 200px;
            backdrop-filter: blur(5px);
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .tooltip-title {
            font-weight: bold;
            color: #4fc3f7;
            margin-bottom: 5px;
            text-transform: uppercase;
        }

        .tooltip-content {
            color: #ffffff;
            line-height: 1.4;
        }

        .tooltip-link {
            color: #ff9800;
            text-decoration: none;
            display: block;
            margin-top: 5px;
            font-size: 9px;
        }

        .tooltip-link:hover {
            text-decoration: underline;
        }

        .tooltip-severity {
            position: absolute;
            top: -8px;
            right: -8px;
            width: 16px;
            height: 16px;
            border-radius: 50%;
            border: 2px solid #0a0a0a;
        }

        .tooltip-severity.critical { background: #f44336; }
        .tooltip-severity.high { background: #ff9800; }
        .tooltip-severity.low { background: #4caf50; }

        /* Responsive design */
        @media (max-width: 1200px) {
            .main-grid {
                grid-template-columns: 1fr;
                grid-template-rows: auto;
            }
            
            .map-container {
                grid-column: 1;
                grid-row: auto;
                min-height: 400px;
            }
            
            .bottom-panels {
                grid-column: 1;
                flex-direction: column;
            }

            .control-toggles {
                flex-direction: column;
                gap: 10px;
            }
        }

        @keyframes gaugeRotate {
            0% { transform: rotate(0deg); }
            50% { transform: rotate(180deg); }
            100% { transform: rotate(270deg); }
        }

        @keyframes slideInLeft {
            from { transform: translateX(-20px); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }

        @keyframes slideInRight {
            from { transform: translateX(20px); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }

        @keyframes float {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-5px); }
        }

        @keyframes radarSweep {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        @keyframes rotateDots {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* Custom scrollbar */
        ::-webkit-scrollbar {
            width: 8px;
        }

        ::-webkit-scrollbar-track {
            background: rgba(0, 0, 0, 0.2);
            border-radius: 4px;
        }

        ::-webkit-scrollbar-thumb {
            background: linear-gradient(45deg, #4fc3f7, #2196f3);
            border-radius: 4px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: linear-gradient(45deg, #00ff88, #4fc3f7);
        }

        /* Styles for top targeted countries */
        .country-stats {
            display: flex;
            flex-direction: column;
            gap: 8px;
            margin-top: 10px;
        }
        
        .country-item {
            display: flex;
            align-items: center;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 6px;
            padding: 8px;
            font-size: 10px;
            transition: all 0.3s ease;
            cursor: pointer;
        }
        
        .country-item:hover {
            background: rgba(0, 0, 0, 0.4);
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(79, 195, 247, 0.2);
        }
        
        .country-flag {
            width: 20px;
            height: 15px;
            margin-right: 10px;
            border-radius: 2px;
            object-fit: cover;
        }
        
        .country-name {
            flex: 1;
            font-weight: bold;
            color: #4fc3f7;
        }
        
        .country-attacks {
            font-weight: bold;
            color: #f44336;
            margin-left: 10px;
        }
        
        .attack-progress {
            height: 4px;
            background: rgba(79, 195, 247, 0.2);
            border-radius: 2px;
            margin-top: 4px;
            overflow: hidden;
        }
        
        .attack-progress-bar {
            height: 100%;
            background: linear-gradient(90deg, #f44336, #ff9800);
            border-radius: 2px;
            transition: width 0.5s ease;
        }
    </style>
</head>
<body>
    
    <div class="main-grid">
        <div class="left-panel">
            <div class="circle">
                <div class="circle-value" id="eventsValue">0</div>
                <div class="circle-label">Global Threat Pulse</div>
            </div>
            <div class="circle critical">
                <div class="circle-value" id="criticalValue">0</div>
                <div class="circle-label">Critical Threat Vectors</div>
            </div>
            <div class="circle alerts">
                <div class="circle-value" id="alertsValue">0</div>
                <div class="circle-label">Actionable Threat Feeds</div>
            </div>
        </div>

        <div class="map-container">
            <div id="worldMap"></div>
            <div class="map-legend">
                <div class="legend-item">
                    <div class="legend-color critical-threat"></div>
                    <span>Critical Threats</span>
                </div>
                <div class="legend-item">
                    <div class="legend-color high-threat"></div>
                    <span>High Threats</span>
                </div>
                <div class="legend-item">
                    <div class="legend-color low-threat"></div>
                    <span>Low Threats</span>
                </div>
            </div>
        </div>

        <div class="right-panel">
            <div class="threat-intel-feed">
                <div class="panel-title">
                    <i class="fas fa-globe-americas"></i>
                    Global Threat Intelligence
                </div>
                <div id="threatIntelList" class="threat-intel-list">
                    <div class="loading">
                        <div class="spinner"></div>
                        Loading threat intelligence...
                    </div>
                </div>
            </div>
            
            <div class="right-chart">
                <div class="gauge-chart">
                    <div class="gauge-bg">
                        <div class="gauge-fill"></div>
                    </div>
                    <div class="gauge-center">
                        <div class="gauge-value" id="eventsPerSecond">0 Cyber Flux</div>
                        <div class="gauge-label">Events/Sec</div>
                    </div>
                </div>
            </div>
            
            <div class="recent-alerts">
                <div class="panel-title">
                    <i class="fas fa-bell"></i>
                    Recent Alerts
                </div>
                <div id="alertsList">
                    <div class="loading">
                        <div class="spinner"></div>
                        Loading alerts...
                    </div>
                </div>
            </div>
        </div>

        <div class="bottom-panels">
            <div class="bottom-panel">
                <div class="panel-title">
                    <i class="fas fa-exclamation-triangle"></i>
                    Critical Severity Threats
                </div>
                <div id="criticalThreats">
                    <div class="loading">
                        <div class="spinner"></div>
                        Loading critical threats...
                    </div>
                </div>
            </div>
            
            <div class="bottom-panel">
                <div class="panel-title">
                    <i class="fas fa-shield-alt"></i>
                    High Severity Threats
                </div>
                <div id="highPriority">
                    <div class="loading">
                        <div class="spinner"></div>
                        Loading high priority threats...
                    </div>
                </div>
            </div>
            
            <div class="bottom-panel">
                <div class="panel-title">
                    <i class="fas fa-globe"></i>
                    Top Targeted Countries
                </div>
                <div id="topCountries" class="country-stats">
                    <div class="loading">
                        <div class="spinner"></div>
                        Loading country data...
                    </div>
                </div>
            </div>
            
            <div class="bottom-panel">
                <div class="panel-title">
                    <i class="fas fa-desktop"></i>
                    Device Types
                </div>
                <div class="device-cloud">
                    <span class="device-type">onedrive</span>
                    <span class="device-type">cloudflare</span>
                    <span class="device-type">outlook</span>
                    <span class="device-type">FortinetFW</span>
                    <span class="device-type">general</span>
                    <span class="device-type">office_365</span>
                    <span class="device-type">linux_os</span>
                    <span class="device-type">azuread</span>
                    <span class="device-type">flow</span>
                    <span class="device-type">awsaudit</span>
                    <span class="device-type">fortiweb</span>
                    <span class="device-type">exchange</span>
                    <span class="device-type">apache</span>
                    <span class="device-type">ms_window</span>
                    <span class="device-type">fortinet</span>
                    <span class="device-type">openvpn3</span>
                    <span class="device-type">sharepoint</span>
                </div>
            </div>
        </div>
    </div>

    <script src="https://d3js.org/d3.v7.min.js"></script>
    <script src="https://d3js.org/topojson.v3.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/socket.io-client@4.7.2/dist/socket.io.min.js"></script>
    <script>
    // ===== MAP INITIALIZATION =====
    const mapContainer = document.getElementById('worldMap');
    const width = mapContainer.clientWidth;
    const height = mapContainer.clientHeight;
    
    // Create SVG for the map
    const svg = d3.select(mapContainer)
        .append("svg")
        .attr("width", width)
        .attr("height", height);
    
    // Projection and path
    const projection = d3.geoMercator()
        .scale(width / 6)
        .translate([width / 2, height / 1.5]);
    
    const path = d3.geoPath().projection(projection);
    
    // Load world map data
    d3.json("https://unpkg.com/world-atlas@2.0.2/countries-50m.json").then(world => {
        const countries = topojson.feature(world, world.objects.countries).features;
        
        // Draw countries with subtle outlines
        svg.selectAll(".country")
            .data(countries)
            .enter()
            .append("path")
            .attr("class", "country")
            .attr("d", path)
            .attr("fill", "rgba(0,0,0,0)")
            .attr("stroke", "#4fc3f7")
            .attr("stroke-width", 0.3)
            .attr("stroke-opacity", 0.2);
    });

    // Create attacker base
    const attackerBase = document.createElement('div');
    attackerBase.className = 'attacker-base';
    attackerBase.textContent = 'ðŸ’€';
    attackerBase.title = "Primary Attacker Location";
    mapContainer.appendChild(attackerBase);

    // ===== GLOBAL THREAT DATA =====
    const globalThreatLocations = {
        'United States': { 
            lat: 39.8283, 
            lng: -98.5795, 
            code: 'US', 
            attacks: 45,
            headline: "Massive data breach affects 3 US government agencies",
            flag: "https://flagcdn.com/w20/us.png",
            targets: ['China', 'Russia', 'Iran', 'North Korea']
        },
        'China': { 
            lat: 35.8617, 
            lng: 104.1954, 
            code: 'CN', 
            attacks: 38,
            headline: "New APT group targeting financial institutions",
            flag: "https://flagcdn.com/w20/cn.png",
            targets: ['United States', 'Japan', 'South Korea', 'Taiwan']
        },
        'Russia': { 
            lat: 61.5240, 
            lng: 105.3188, 
            code: 'RU', 
            attacks: 52,
            headline: "State-sponsored hackers target energy infrastructure",
            flag: "https://flagcdn.com/w20/ru.png",
            targets: ['United States', 'Ukraine', 'United Kingdom', 'Germany']
        },
        'United Kingdom': { 
            lat: 54.7024, 
            lng: -3.2768, 
            code: 'GB', 
            attacks: 28,
            headline: "NHS systems hit by ransomware attack",
            flag: "https://flagcdn.com/w20/gb.png",
            targets: ['Russia', 'Iran', 'China']
        },
        'Germany': { 
            lat: 51.1657, 
            lng: 10.4515, 
            code: 'DE', 
            attacks: 22,
            headline: "German automotive companies targeted in supply chain attack",
            flag: "https://flagcdn.com/w20/de.png",
            targets: ['Russia', 'China']
        },
        'France': { 
            lat: 46.6034, 
            lng: 1.8883, 
            code: 'FR', 
            attacks: 19,
            headline: "French defense contractors suffer data leaks",
            flag: "https://flagcdn.com/w20/fr.png",
            targets: ['Russia', 'China']
        },
        'Japan': { 
            lat: 36.2048, 
            lng: 138.2529, 
            code: 'JP', 
            attacks: 15,
            headline: "Japanese tech firms targeted in credential stuffing attacks",
            flag: "https://flagcdn.com/w20/jp.png",
            targets: ['China', 'North Korea']
        },
        'South Korea': { 
            lat: 35.9078, 
            lng: 127.7669, 
            code: 'KR', 
            attacks: 12,
            headline: "South Korean crypto exchanges under DDoS attack",
            flag: "https://flagcdn.com/w20/kr.png",
            targets: ['North Korea', 'China']
        },
        'India': { 
            lat: 20.5937, 
            lng: 78.9629, 
            code: 'IN', 
            attacks: 18,
            headline: "Indian government websites defaced by hacktivists",
            flag: "https://flagcdn.com/w20/in.png",
            targets: ['China', 'Pakistan']
        },
        'Brazil': { 
            lat: -14.2350, 
            lng: -51.9253, 
            code: 'BR', 
            attacks: 10,
            headline: "Brazilian financial sector targeted in banking trojan campaign",
            flag: "https://flagcdn.com/w20/br.png",
            targets: ['United States', 'Russia']
        },
        'Iran': { 
            lat: 32.4279, 
            lng: 53.6880, 
            code: 'IR', 
            attacks: 32,
            headline: "Iranian hackers target Middle Eastern governments",
            flag: "https://flagcdn.com/w20/ir.png",
            targets: ['Israel', 'United States', 'Saudi Arabia']
        },
        'North Korea': { 
            lat: 40.3399, 
            lng: 127.5101, 
            code: 'KP', 
            attacks: 41,
            headline: "Lazarus Group expands cryptocurrency theft operations",
            flag: "https://flagcdn.com/w20/kp.png",
            targets: ['South Korea', 'United States', 'Japan']
        }
    };

    // Function to create attack connections between countries
    function createCountryAttackConnection(sourceCountry, targetCountry, intensity) {
        const source = globalThreatLocations[sourceCountry];
        const target = globalThreatLocations[targetCountry];
        
        if (!source || !target) return;
        
        const [sourceX, sourceY] = projection([source.lng, source.lat]);
        const [targetX, targetY] = projection([target.lng, target.lat]);
        
        const lineLength = Math.sqrt(Math.pow(targetX - sourceX, 2) + Math.pow(targetY - sourceY, 2));
        const angle = Math.atan2(targetY - sourceY, targetX - sourceX) * (180 / Math.PI);
        
        // Create connection line
        const line = document.createElement('div');
        line.className = 'attack-line';
        line.style.setProperty('--line-length', `${lineLength}px`);
        line.style.left = `${sourceX}px`;
        line.style.top = `${sourceY}px`;
        line.style.transform = `rotate(${angle}deg)`;
        
        // Set line color based on intensity
        if (intensity > 40) {
            line.style.height = '3px';
            line.style.background = 'linear-gradient(90deg, rgba(244, 67, 54, 0.9), rgba(244, 67, 54, 0.1))';
            line.style.boxShadow = '0 0 15px rgba(244, 67, 54, 0.7)';
        } else if (intensity > 20) {
            line.style.height = '2px';
            line.style.background = 'linear-gradient(90deg, rgba(255, 152, 0, 0.9), rgba(255, 152, 0, 0.1))';
            line.style.boxShadow = '0 0 12px rgba(255, 152, 0, 0.6)';
        } else {
            line.style.height = '1px';
            line.style.background = 'linear-gradient(90deg, rgba(76, 175, 80, 0.9), rgba(76, 175, 80, 0.1))';
            line.style.boxShadow = '0 0 8px rgba(76, 175, 80, 0.5)';
        }
        
        // Create moving attack packet
        const packet = document.createElement('div');
        packet.className = 'attack-packet';
        packet.style.left = `${sourceX}px`;
        packet.style.top = `${sourceY}px`;
        packet.style.setProperty('--tx', `${targetX-sourceX}px`);
        packet.style.setProperty('--ty', `${targetY-sourceY}px`);
        packet.style.animationDuration = `${1 + Math.random()}s`;
        
        // Set packet color based on intensity
        if (intensity > 40) {
            packet.style.background = '#f44336';
            packet.style.boxShadow = '0 0 10px #f44336';
        } else if (intensity > 20) {
            packet.style.background = '#ff9800';
            packet.style.boxShadow = '0 0 8px #ff9800';
        } else {
            packet.style.background = '#4caf50';
            packet.style.boxShadow = '0 0 6px #4caf50';
        }
        
        mapContainer.appendChild(line);
        mapContainer.appendChild(packet);
        
        // Remove elements after animation completes
        setTimeout(() => {
            line.remove();
            packet.remove();
        }, 3000);
    }

    // New function to update top countries list
    function updateTopCountries() {
        const container = document.getElementById('topCountries');
        container.innerHTML = ''; // Clear existing items

        // Sort countries by attack count
        const sortedCountries = Object.entries(globalThreatLocations)
            .sort((a, b) => b[1].attacks - a[1].attacks)
            .slice(0, 6);

        // Find max attacks for progress bar scaling
        const maxAttacks = Math.max(...sortedCountries.map(c => c[1].attacks));
        
        sortedCountries.forEach(([country, data]) => {
            const countryDiv = document.createElement('div');
            countryDiv.className = 'country-item';
            countryDiv.innerHTML = `
                <img src="${data.flag}" alt="${country}" class="country-flag">
                <span class="country-name">${country}</span>
                <span class="country-attacks">${data.attacks}</span>
                <div class="attack-progress">
                    <div class="attack-progress-bar" style="width: ${(data.attacks / maxAttacks) * 100}%"></div>
                </div>
            `;
            
            // Add click event to show attack connections
            countryDiv.addEventListener('click', () => {
                // Highlight this country's attack connections
                const countryData = globalThreatLocations[country];
                if (countryData.targets) {
                    countryData.targets.forEach(target => {
                        const intensity = countryData.attacks;
                        createCountryAttackConnection(country, target, intensity);
                    });
                }
            });
            
            container.appendChild(countryDiv);
        });
    }

    // Function to update threat visualization
    function updateThreatVisualization() {
        // Clear existing elements
        d3.selectAll(".threat-dot").remove();
        document.querySelectorAll('.connection-line').forEach(el => el.remove());
        document.querySelectorAll('.threat-tooltip').forEach(el => el.remove());
        
        // Create tooltip element
        const tooltip = document.createElement('div');
        tooltip.className = 'tooltip';
        tooltip.id = 'threatTooltip';
        mapContainer.appendChild(tooltip);
        
        // Add threat dots and connections
        Object.entries(globalThreatLocations).forEach(([country, data]) => {
            const [x, y] = projection([data.lng, data.lat]);
            const severity = data.attacks > 40 ? 'critical' : 
                           data.attacks > 20 ? 'high' : 'low';
            
            // Create threat dot
            const dot = document.createElement('div');
            dot.className = `threat-dot ${severity}`;
            dot.style.left = `${x}px`;
            dot.style.top = `${y}px`;
            dot.style.width = `${6 + (data.attacks / 5)}px`;
            dot.style.height = `${6 + (data.attacks / 5)}px`;
            dot.dataset.country = country;
            dot.dataset.severity = severity;
            dot.dataset.attacks = data.attacks;
            mapContainer.appendChild(dot);
            
            // Add hover and click events to threat dots
            dot.addEventListener('mouseenter', (e) => {
                const tooltip = document.getElementById('threatTooltip');
                let tooltipContent = `
                    <div class="tooltip-severity ${severity}"></div>
                    <div class="tooltip-title">${country}</div>
                    <div class="tooltip-content">
                        <strong>Severity:</strong> ${severity.toUpperCase()}<br>
                        <strong>Attack volume:</strong> ${data.attacks} incidents<br>
                `;
                
                // Show attack sources if this country is being targeted
                const attackers = Object.entries(globalThreatLocations)
                    .filter(([_, locData]) => locData.targets && locData.targets.includes(country))
                    .map(([name]) => name);
                
                if (attackers.length > 0) {
                    tooltipContent += `<br><strong>Primary Attack Sources:</strong><br>`;
                    tooltipContent += attackers.join(', ');
                }
                
                // Show targets if this country is attacking others
                if (data.targets && data.targets.length > 0) {
                    tooltipContent += `<br><strong>Primary Targets:</strong><br>`;
                    tooltipContent += data.targets.join(', ');
                }
                
                tooltipContent += `
                        <br><br>
                        <a href="https://www.google.com/search?q=${encodeURIComponent(country + ' cybersecurity threat')}" 
                           target="_blank" class="tooltip-link">
                            View threat intelligence reports â†’
                        </a>
                    </div>
                `;
                
                tooltip.innerHTML = tooltipContent;
                tooltip.style.left = `${x + 15}px`;
                tooltip.style.top = `${y - 15}px`;
                tooltip.style.opacity = '1';
            });
            
            dot.addEventListener('mouseleave', () => {
                const tooltip = document.getElementById('threatTooltip');
                tooltip.style.opacity = '0';
            });
            
            dot.addEventListener('click', () => {
                // Show all attack connections from this country
                if (data.targets) {
                    data.targets.forEach(target => {
                        createCountryAttackConnection(country, target, data.attacks);
                    });
                }
            });
        });
        
        // Add tooltip for attacker base
        attackerBase.addEventListener('mouseenter', () => {
            const tooltip = document.getElementById('threatTooltip');
            tooltip.innerHTML = `
                <div class="tooltip-title">ATTACKER BASE</div>
                <div class="tooltip-content">
                    Primary threat origin location<br>
                    Monitoring global attack patterns<br>
                    <span style="color: #f44336;">High activity detected</span>
                </div>
            `;
            tooltip.style.left = `${width/2 - 100}px`;
            tooltip.style.top = `${height - 80}px`;
            tooltip.style.opacity = '1';
        });
        
        attackerBase.addEventListener('mouseleave', () => {
            const tooltip = document.getElementById('threatTooltip');
            tooltip.style.opacity = '0';
        });
    }

    // ===== DASHBOARD FUNCTIONALITY =====
    // Socket.IO connection for real-time updates
    const socket = io();
    
    socket.on('threatIntelUpdate', (data) => {
        activeThreats = data.threats;
        updateGlobalThreatFeed();
        updateDashboardStats();
        updateThreatVisualization();
        updateTopCountries();
    });
    
    socket.on('recentAlertsUpdate', (data) => {
        activeAlerts = data.alerts;
        updateRecentAlerts();
    });

    let activeThreats = [];
    let activeAlerts = [];
    let eventsPerSecond = 0;

    function updateGlobalThreatFeed() {
        const threatList = document.getElementById('threatIntelList');
        
        if (threatList.querySelector('.loading')) {
            threatList.innerHTML = '';
        }
        
        // Filter to only show critical and high severity threats
        const filteredThreats = activeThreats.filter(t => 
            t.severity === 'critical' || t.severity === 'high'
        ).slice(0, 10);
        
        filteredThreats.forEach((threat, index) => {
            const threatDiv = document.createElement('div');
            threatDiv.className = `threat-intel-item ${threat.severity || 'high'}`;
            
            // Create clickable link
            const threatLink = document.createElement('a');
            threatLink.href = threat.url || '#';
            threatLink.target = '_blank';
            threatLink.innerHTML = `
                <div class="threat-severity severity-${threat.severity || 'high'}">${threat.severity || 'high'}</div>
                <div class="threat-header">
                    <span class="threat-source">${threat.source || 'Unknown'}</span>
                    <span class="threat-time">${formatTime(threat.timestamp)}</span>
                </div>
                <div class="threat-description">${threat.title || 'No title available'}</div>
            `;
            
            threatDiv.appendChild(threatLink);
            threatList.appendChild(threatDiv);
        });
    }

    function updateThreatList(elementId, threats) {
        const container = document.getElementById(elementId);
        
        if (container.querySelector('.loading')) {
            container.innerHTML = '';
        }
        
        container.innerHTML = '';
        
        threats.forEach(threat => {
            const threatDiv = document.createElement('div');
            threatDiv.className = `threat-item ${threat.severity || 'high'}`;
            
            // Create clickable link
            const threatLink = document.createElement('a');
            threatLink.href = threat.url || '#';
            threatLink.target = '_blank';
            threatLink.style.textDecoration = 'none';
            threatLink.style.color = 'inherit';
            threatLink.innerHTML = `
                <div style="display: flex; justify-content: space-between;">
                    <strong>${threat.title || 'Unknown Threat'}</strong>
                    <small>${formatTime(threat.timestamp)}</small>
                </div>
            `;
            
            threatDiv.appendChild(threatLink);
            container.appendChild(threatDiv);
        });
    }
    
    function updateRecentAlerts() {
        const alertsList = document.getElementById('alertsList');
        
        if (alertsList.querySelector('.loading')) {
            alertsList.innerHTML = '';
        }
        
        // Create container for scrolling alerts
        alertsList.innerHTML = '<div class="alerts-container"></div>';
        const container = alertsList.querySelector('.alerts-container');
        
        // Add all alerts to container
        activeAlerts.forEach(alert => {
            const alertDiv = document.createElement('div');
            alertDiv.className = 'alert-item';
            alertDiv.innerHTML = `
                <div style="display: flex; justify-content: space-between; align-items: center;">
                    <span>${alert.title || alert.message || 'Security Alert'}</span>
                    <small style="opacity: 0.7;">${formatTime(alert.timestamp)}</small>
                </div>
            `;
            container.appendChild(alertDiv);
        });
        
        // Clone alerts for seamless looping
        activeAlerts.forEach(alert => {
            const alertDiv = document.createElement('div');
            alertDiv.className = 'alert-item';
            alertDiv.innerHTML = `
                <div style="display: flex; justify-content: space-between; align-items: center;">
                    <span>${alert.title || alert.message || 'Security Alert'}</span>
                    <small style="opacity: 0.7;">${formatTime(alert.timestamp)}</small>
                </div>
            `;
            container.appendChild(alertDiv.cloneNode(true));
        });
    }
    
    function updateDashboardStats() {
        const criticalCount = activeThreats.filter(t => t.severity === 'critical').length;
        const highCount = activeThreats.filter(t => t.severity === 'high').length;
        const lowCount = activeThreats.filter(t => t.severity === 'low').length;
        
        const totalEventsRaw = activeThreats.length * 1250000;
        const criticalEventsRaw = criticalCount * 2500 + highCount * 500;
        const totalAlertsRaw = criticalCount + highCount + lowCount;
        
        eventsPerSecond = Math.max(1, Math.floor(activeThreats.length / 10));
        
        document.getElementById('eventsValue').textContent = formatNumber(totalEventsRaw);
        document.getElementById('criticalValue').textContent = formatNumber(criticalEventsRaw);
        document.getElementById('alertsValue').textContent = formatNumber(totalAlertsRaw);
        document.getElementById('eventsPerSecond').textContent = `${eventsPerSecond} EPS`;
        
        // Update critical threats list
        updateThreatList('criticalThreats', activeThreats.filter(t => t.severity === 'critical').slice(0, 5));
        
        // Update high priority threats list
        updateThreatList('highPriority', activeThreats.filter(t => t.severity === 'high').slice(0, 5));
    }
    
    function formatTime(timestamp) {
        if (!timestamp) return 'Just now';
        
        const date = new Date(timestamp);
        const now = new Date();
        const diff = now - date;
        
        if (diff < 60000) return 'Just now';
        if (diff < 3600000) return `${Math.floor(diff / 60000)}m ago`;
        if (diff < 86400000) return `${Math.floor(diff / 3600000)}h ago`;
        return `${Math.floor(diff / 86400000)}d ago`;
    }
    
    function formatNumber(num) {
        if (num >= 1000000) {
            return (num / 1000000).toFixed(1) + 'M';
        }
        if (num >= 1000) {
            return (num / 1000).toFixed(1) + 'K';
        }
        return num.toString();
    }
    
    function getThreatLocation(threat) {
        if (threat.country) {
            return `${threat.country} ${threat.city ? `(${threat.city})` : ''}`;
        }
        return 'Global';
    }
    
    // ===== INITIALIZATION =====
    function initDashboard() {
        // Initialize the top countries section
        updateTopCountries();
        
        // Initialize threat visualization
        updateThreatVisualization();
        
        // Start periodic attack animations between countries
        setInterval(() => {
            const countries = Object.keys(globalThreatLocations);
            if (countries.length > 0) {
                // Select a random source country that has targets
                let sourceCountry, targetCountry;
                do {
                    sourceCountry = countries[Math.floor(Math.random() * countries.length)];
                    const sourceData = globalThreatLocations[sourceCountry];
                    if (sourceData.targets && sourceData.targets.length > 0) {
                        targetCountry = sourceData.targets[Math.floor(Math.random() * sourceData.targets.length)];
                    }
                } while (!targetCountry);
                
                const intensity = globalThreatLocations[sourceCountry].attacks;
                createCountryAttackConnection(sourceCountry, targetCountry, intensity);
            }
        }, 1000);
        
        // Load initial data
        fetch('/api/threat-intel')
            .then(response => response.json())
            .then(data => {
                activeThreats = data.threats;
                updateGlobalThreatFeed();
                updateDashboardStats();
                updateThreatVisualization();
                updateTopCountries();
            })
            .catch(error => {
                console.log('Simulating threat intel data...');
                // Simulate data if API is not available
                activeThreats = [
                    { severity: 'critical', title: 'Advanced Persistent Threat Detected', source: 'FireEye', timestamp: new Date() },
                    { severity: 'high', title: 'Ransomware Campaign Active', source: 'CrowdStrike', timestamp: new Date() },
                    { severity: 'critical', title: 'Zero-Day Exploit in the Wild', source: 'Mandiant', timestamp: new Date() }
                ];
                updateGlobalThreatFeed();
                updateDashboardStats();
            });
        
        fetch('/api/recent-alerts')
            .then(response => response.json())
            .then(data => {
                activeAlerts = data.alerts;
                updateRecentAlerts();
            })
            .catch(error => {
                console.log('Simulating alerts data...');
                // Simulate data if API is not available
                activeAlerts = [
                    { title: 'Suspicious Login Activity', timestamp: new Date() },
                    { title: 'Malware Detected', timestamp: new Date() },
                    { title: 'Data Exfiltration Attempt', timestamp: new Date() }
                ];
                updateRecentAlerts();
            });
        
        // Simulate real-time updates
        setInterval(() => {
            eventsPerSecond = Math.max(1, Math.floor(eventsPerSecond * (0.9 + Math.random() * 0.2)));
            document.getElementById('eventsPerSecond').textContent = `${eventsPerSecond} EPS`;
            
            if (Math.random() > 0.7) {
                const randomIndex = Math.floor(Math.random() * activeThreats.length);
                const threat = activeThreats[randomIndex];
                
                // Only add if it's critical or high severity
                if (threat && (threat.severity === 'critical' || threat.severity === 'high')) {
                    const threatDiv = document.createElement('div');
                    threatDiv.className = `threat-intel-item ${threat.severity || 'high'}`;
                    threatDiv.innerHTML = `
                        <div class="threat-severity severity-${threat.severity || 'high'}">${threat.severity || 'high'}</div>
                        <div class="threat-header">
                            <span class="threat-source">${threat.source || 'Unknown'}</span>
                            <span class="threat-time">${formatTime(threat.timestamp)}</span>
                        </div>
                        <div class="threat-description">${threat.title || 'No title available'}</div>
                    `;
                    
                    const threatList = document.getElementById('threatIntelList');
                    threatList.insertBefore(threatDiv, threatList.firstChild);
                    
                    if (threatList.children.length > 10) {
                        threatList.removeChild(threatList.lastChild);
                    }
                }
            }
        }, 3000);
    }
    
    // Start the dashboard when DOM is loaded
    document.addEventListener('DOMContentLoaded', initDashboard);
</script>
</body>
</html>
